# Plan 26-02: AI System Prompt Updates

**Phase:** 26 - AI & Wizard Updates
**Wave:** 1
**Requirements:** AI-01, AI-02, AI-03, WIZ-02

## Objective

Update the AI system prompt for BOM generation to use the new 6-category structure, provide category assignment guidance, and require dimensions for all lumber items.

## Files Modified

- `src/routes/api/bom/generate/+server.ts` — Rewrote `buildBOMPrompt()` function

## Implementation Summary

### Task 1: Update Category Instructions (AI-01)
Replaced 4-category instruction with 6 categories:
- HARDWOOD LUMBER (category: "hardwood")
- COMMON BOARDS (category: "common")
- SHEET GOODS (category: "sheet")
- HARDWARE (category: "hardware")
- FINISHES (category: "finishes")
- CONSUMABLES (category: "consumables")

### Task 2: Category Assignment Logic (AI-02)
Added explicit guidance on assigning lumber categories based on wood species:
- Hardwood species (Oak, Maple, Walnut, etc.) → "hardwood"
- Softwood/construction (Pine, Fir, SPF, etc.) → "common"
- Sheet materials (Plywood, MDF, etc.) → "sheet"
- Default to "hardwood" when ambiguous

### Task 3: Dimension Requirements (AI-03)
Added explicit dimension requirements section:
- All lumber items MUST include length, width, thickness
- Use actual measurements (not nominal)
- Examples: "3/4 stock" = 0.75 thickness, "2x4" = 3.5 width, 1.5 thickness
- Unit: always "pcs" for lumber categories

### Task 4: Conditional Consumables (WIZ-02)
Modified prompt generation based on `includeConsumables` flag:
- If true: Include consumables section as normal
- If false: Add instruction "Do NOT include any consumable items"

## Verification

- [ ] AI generates BOMs with hardwood/common/sheet categories
- [ ] AI assigns correct category based on wood species input
- [ ] All lumber items have length, width, thickness fields populated
- [ ] Consumables toggle correctly includes/excludes consumables from AI output

## Status

**COMPLETE** — Executed 2026-02-04
