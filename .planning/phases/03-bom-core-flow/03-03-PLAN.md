---
phase: 03-bom-core-flow
plan: 03
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/lib/components/bom/WizardProgress.svelte
  - src/lib/components/bom/ProjectTypeStep.svelte
  - src/lib/components/bom/DimensionsStep.svelte
  - src/lib/components/bom/JoineryStep.svelte
  - src/lib/components/bom/MaterialsStep.svelte
  - src/lib/components/bom/BOMWizard.svelte
autonomous: true

must_haves:
  truths:
    - "User can select a project template from visual cards"
    - "User can enter custom dimensions with validation"
    - "User can select one or more joinery methods"
    - "User can specify wood species and finish preferences"
    - "Wizard progresses through 4 steps with visual indicator"
  artifacts:
    - path: "src/lib/components/bom/WizardProgress.svelte"
      provides: "Step progress indicator"
      min_lines: 20
    - path: "src/lib/components/bom/ProjectTypeStep.svelte"
      provides: "Template selection cards"
      min_lines: 30
    - path: "src/lib/components/bom/DimensionsStep.svelte"
      provides: "Dimension input form"
      min_lines: 40
    - path: "src/lib/components/bom/JoineryStep.svelte"
      provides: "Joinery selection checkboxes"
      min_lines: 30
    - path: "src/lib/components/bom/MaterialsStep.svelte"
      provides: "Materials and finish selection"
      min_lines: 40
    - path: "src/lib/components/bom/BOMWizard.svelte"
      provides: "Wizard container with step management"
      min_lines: 60
  key_links:
    - from: "BOMWizard.svelte"
      to: "templates.ts"
      via: "imports templates array"
      pattern: "import.*templates.*from.*data/templates"
    - from: "BOMWizard.svelte"
      to: "ProjectDetails type"
      via: "imports type for output"
      pattern: "import.*ProjectDetails.*from.*types/bom"
---

<objective>
Build the guided prompt wizard UI components for collecting BOM project details.

Purpose: Create a step-by-step wizard that guides users through providing project information (type, dimensions, joinery, materials). This ensures all required information is gathered before BOM generation.

Output: 6 Svelte components forming a complete 4-step wizard interface.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-02-SUMMARY.md

# Existing component patterns to follow:
@src/lib/components/ToolCard.svelte
@src/lib/components/ChatInput.svelte

# Types and templates from 03-01 (will exist after that plan completes):
# @src/lib/types/bom.ts
# @src/lib/data/templates.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create wizard step components</name>
  <files>src/lib/components/bom/WizardProgress.svelte, src/lib/components/bom/ProjectTypeStep.svelte, src/lib/components/bom/DimensionsStep.svelte, src/lib/components/bom/JoineryStep.svelte, src/lib/components/bom/MaterialsStep.svelte</files>
  <action>
Create the `src/lib/components/bom/` directory and implement 5 step components:

**1. WizardProgress.svelte**
Props: currentStep (1-4), totalSteps (default 4)
- Display step indicator showing progress
- Visual distinction for completed, current, and upcoming steps
- Step labels: "Project Type", "Dimensions", "Joinery", "Materials"
- Use amber color scheme for completed/current steps
- Horizontal layout with connecting lines between steps

**2. ProjectTypeStep.svelte**
Props: templates (ProjectTemplate[]), onSelect (callback with template)
- Display template cards in a responsive grid (similar to dashboard ToolCard pattern)
- Each card shows: icon, name, description
- Hover effect on cards
- Click to select and advance
- Use Svelte 5 $props() pattern

**3. DimensionsStep.svelte**
Props: template (selected ProjectTemplate), initialValues, onSubmit, onBack
- Display form with number inputs for length, width, height (height optional based on template)
- Pre-fill with template's default dimensions
- Validate against template's min/max ranges
- Unit selector (inches/cm) - default to inches
- Show validation errors inline
- "Back" and "Next" buttons
- Optional project name input field

**4. JoineryStep.svelte**
Props: template (selected ProjectTemplate), initialValues, onSubmit, onBack
- Display checkboxes/cards for each joinery option from template
- Each option shows: name, description, difficulty badge (color-coded: green/yellow/red)
- At least one selection required
- Multi-select enabled
- "Back" and "Next" buttons

**5. MaterialsStep.svelte**
Props: template (selected ProjectTemplate), initialValues, onSubmit, onBack
- Wood species dropdown with template suggestions + "Other" option with text input
- Finish type dropdown with template suggestions + "Other" option with text input
- Optional "Additional notes" textarea for special requirements
- "Back" and "Generate BOM" buttons (Generate styled as primary action)

All components should:
- Use Svelte 5 $props() and $state() syntax
- Follow existing Tailwind patterns (amber color scheme, consistent spacing)
- Be properly typed with TypeScript
  </action>
  <verify>npm run check passes, all 5 component files exist without TypeScript errors</verify>
  <done>5 step components created with proper props, styling, and validation</done>
</task>

<task type="auto">
  <name>Task 2: Create wizard container component</name>
  <files>src/lib/components/bom/BOMWizard.svelte</files>
  <action>
Create the main wizard container that orchestrates the step flow:

**BOMWizard.svelte**
Props: onComplete (callback with ProjectDetails)

Internal state:
- currentStep: number (1-4)
- selectedTemplate: ProjectTemplate | null
- projectDetails: Partial<ProjectDetails>

Implementation:
1. Import all step components and templates
2. Manage step state with $state()
3. Render WizardProgress at top
4. Conditionally render current step component
5. Handle step transitions:
   - Step 1: On template select → save template, advance to step 2
   - Step 2: On submit → save dimensions, advance to step 3
   - Step 3: On submit → save joinery, advance to step 4
   - Step 4: On submit → compile ProjectDetails, call onComplete
6. Handle back navigation (decrement step)
7. Pass accumulated data to each step as initialValues for back navigation

The wizard maintains all state internally and only emits the complete ProjectDetails when the user finishes the final step.

Type the component output to match ProjectDetails interface from types/bom.ts.
  </action>
  <verify>npm run check passes, BOMWizard imports all step components and templates</verify>
  <done>BOMWizard container manages step flow, state, and emits complete ProjectDetails on finish</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run check` passes (0 errors, 0 warnings)
- [ ] All 6 component files exist in src/lib/components/bom/
- [ ] WizardProgress displays 4 steps with visual progress
- [ ] ProjectTypeStep renders template cards from templates array
- [ ] DimensionsStep shows inputs pre-filled from template defaults
- [ ] JoineryStep displays template's joinery options
- [ ] MaterialsStep shows template's suggested woods and finishes
- [ ] BOMWizard orchestrates all steps and manages state
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Components follow established Svelte 5 and Tailwind patterns
- Wizard flow is complete: template → dimensions → joinery → materials
</success_criteria>

<output>
After completion, create `.planning/phases/03-bom-core-flow/03-03-SUMMARY.md`
</output>
