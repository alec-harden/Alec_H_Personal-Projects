---
phase: 22-ui-refinements-and-cut-list-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/components/Sidebar.svelte
  - src/routes/+page.svelte
  - src/routes/+page.server.ts
  - src/lib/components/ToolCard.svelte
autonomous: true

must_haves:
  truths:
    - "Sidebar has two sections: NAVIGATION (view content) and TOOLS (create content)"
    - "NAVIGATION includes: Dashboard, Projects, BOMs, Cut Lists"
    - "TOOLS includes: Create BOM, Create Cut List"
    - "Wood Movement Calculator is removed from sidebar and dashboard"
    - "Dashboard shows maximum 6 most recent projects"
    - "'Start new build' icon and '+ New project' button remain visible and functional"
  artifacts:
    - path: "src/lib/components/Sidebar.svelte"
      provides: "Reorganized navigation with NAVIGATION and TOOLS sections"
      contains: "NAVIGATION"
    - path: "src/routes/+page.svelte"
      provides: "Dashboard with limited projects and no Wood Movement Calculator"
      min_lines: 200
  key_links:
    - from: "src/lib/components/Sidebar.svelte"
      to: "Navigation routes"
      via: "navItems array"
      pattern: "href.*projects|boms|cutlists"
    - from: "src/routes/+page.server.ts"
      to: "Database query"
      via: "LIMIT 6 on projects query"
      pattern: "limit.*6"
---

<objective>
Reorganize the sidebar navigation into two clear sections (viewing vs creating content), add new navigation links, remove Wood Movement Calculator references, and limit dashboard to 6 most recent projects.

Purpose: Improve information architecture by separating "view content" from "create content" actions. Clean up unused features and optimize dashboard performance.
Output: Restructured Sidebar with NAVIGATION and TOOLS sections, cleaned dashboard without Calculator references, limited to 6 projects.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-ui-refinements-and-cut-list-fixes/22-RESEARCH.md
@src/lib/components/Sidebar.svelte
@src/routes/+page.svelte
@src/routes/+page.server.ts
@src/lib/components/ToolCard.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure Sidebar navigation into two sections</name>
  <files>src/lib/components/Sidebar.svelte</files>
  <action>
1. Replace the single navItems array with two section arrays:

```typescript
interface NavItem {
  label: string;
  href: string;
  icon: string;
  description?: string;
}

const navigationItems: NavItem[] = [
  {
    label: 'Dashboard',
    href: '/',
    icon: 'home',
    description: 'Overview & recent projects'
  },
  {
    label: 'Projects',
    href: '/projects',
    icon: 'folder',
    description: 'View all projects'
  },
  {
    label: 'BOMs',
    href: '/projects',  // Links to projects page which shows BOMs
    icon: 'clipboard',
    description: 'View all bills of materials'
  },
  {
    label: 'Cut Lists',
    href: '/cutlist',
    icon: 'scissors',
    description: 'View all cut lists'
  }
];

const toolItems: NavItem[] = [
  {
    label: 'Create BOM',
    href: '/bom/new',
    icon: 'clipboard-plus',
    description: 'New bill of materials'
  },
  {
    label: 'Create Cut List',
    href: '/cutlist',
    icon: 'scissors-plus',
    description: 'New cut optimizer'
  }
];
```

2. Add new icon paths to the icons object:
```typescript
const icons: Record<string, string> = {
  home: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6',
  folder: 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z',
  clipboard: 'M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01',
  scissors: 'M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 10-4.243 4.243 3 3 0 004.243-4.243zm0-5.758a3 3 0 10-4.243-4.243 3 3 0 004.243 4.243z',
  'clipboard-plus': 'M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9h6m-3-3v6',
  'scissors-plus': 'M14.121 14.121L19 19m-7-7l7-7m-7 7l-2.879 2.879M12 12L9.121 9.121m0 5.758a3 3 0 10-4.243 4.243 3 3 0 004.243-4.243zm0-5.758a3 3 0 10-4.243-4.243 3 3 0 004.243 4.243z'
};
```
Note: scissors-plus can use same path as scissors (plus icon implied by label)

3. Update the template to render two sections:
```svelte
<!-- Navigation -->
<nav class="sidebar-nav">
  <div class="nav-section-label">Navigation</div>
  <ul class="nav-list">
    {#each navigationItems as item}
      <!-- existing nav-item rendering logic -->
    {/each}
  </ul>

  <div class="nav-section-label" style="margin-top: var(--space-lg);">Tools</div>
  <ul class="nav-list">
    {#each toolItems as item}
      <!-- same nav-item rendering logic -->
    {/each}
  </ul>
</nav>
```

4. Remove the Calculator nav item entirely (it was disabled anyway).

5. Remove the `disabled` property and badge logic from NavItem interface since no items will be disabled.
  </action>
  <verify>
- Run `npm run dev` and view sidebar
- Verify two sections visible: "NAVIGATION" and "TOOLS"
- Navigation section has: Dashboard, Projects, BOMs, Cut Lists
- Tools section has: Create BOM, Create Cut List
- No Wood Movement Calculator reference anywhere
- All links navigate correctly
  </verify>
  <done>
- Sidebar has NAVIGATION section with 4 items (Dashboard, Projects, BOMs, Cut Lists)
- Sidebar has TOOLS section with 2 items (Create BOM, Create Cut List)
- Wood Movement Calculator completely removed from sidebar
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove Wood Movement Calculator from dashboard and verify project limit</name>
  <files>src/routes/+page.svelte, src/routes/+page.server.ts</files>
  <action>
1. In `src/routes/+page.svelte`:
   - Remove the Wood Movement Calculator ToolCard from the tools-list section:
     ```svelte
     <!-- DELETE this entire ToolCard -->
     <ToolCard
       title="Wood Movement Calculator"
       description="Calculate seasonal wood movement for your designs and joinery."
       href="/calculator"
       icon="ruler"
       disabled={true}
     />
     ```
   - Keep only BOM Generator and Cut List Optimizer ToolCards
   - Verify the "Start New Build" card and "+ New Project" button remain intact

2. In `src/routes/+page.server.ts`:
   - Verify the query already has `limit: 6` (it should based on earlier work)
   - If not present, add it:
     ```typescript
     const userProjects = await db.query.projects.findMany({
       where: eq(projects.userId, locals.user.id),
       orderBy: [desc(projects.updatedAt)],
       limit: 6  // Only show 6 most recent on dashboard
     });
     ```
   - Ensure orderBy is `desc(projects.createdAt)` or `desc(projects.updatedAt)` for most recent first

3. Verify "Start new build" and "+ New Project" buttons:
   - The new-project-card link should remain pointing to /projects (for authenticated) or /bom/new (unauthenticated)
   - The section header "+ New Project" link should remain functional

Note: The dashboard already limits to 6 projects per STATE.md. This task verifies the limit and removes Calculator.
  </action>
  <verify>
- View dashboard at /
- Tools section shows only 2 cards: BOM Generator, Cut List Optimizer
- No "Wood Movement Calculator" visible anywhere
- Projects section shows max 6 projects (if user has more than 6)
- "Start New Build" card visible and clickable
- "+ New Project" header link visible and clickable
  </verify>
  <done>
- Wood Movement Calculator removed from dashboard Tools section
- Dashboard shows maximum 6 most recent projects (sorted by date)
- "Start new build" and "+ New Project" buttons remain functional
  </done>
</task>

</tasks>

<verification>
1. Sidebar structure:
   - Two labeled sections visible: NAVIGATION and TOOLS
   - Navigation: Dashboard, Projects, BOMs, Cut Lists
   - Tools: Create BOM, Create Cut List
   - No Calculator reference

2. Dashboard:
   - Only 2 tool cards (no Calculator)
   - Maximum 6 projects displayed
   - All action buttons work

3. Navigation:
   - All sidebar links navigate to correct pages
   - Active state highlights correctly

4. Grep verification:
   - `grep -r "calculator" src/` returns no matches (except possibly import cleanup)
   - `grep -r "Wood Movement" src/` returns no matches
</verification>

<success_criteria>
- NAV-01: Left Side Panel reorganized with NAVIGATION (Dashboard, Projects, BOMs, Cut Lists) and TOOLS (Create BOM, Create Cut List) sections
- NAV-02: 'TOOLS' heading added below navigation section
- NAV-03: All Wood Movement Calculator references removed
- NAV-04: Dashboard shows only last 6 projects (sorted by most recent)
- NAV-05: 'Start new build' icon and '+ New project' button remain active
</success_criteria>

<output>
After completion, create `.planning/phases/22-ui-refinements-and-cut-list-fixes/22-02-SUMMARY.md`
</output>
